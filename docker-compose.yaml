---
services:
  monitor:
    image: phone-monitor:latest
    environment:
      - "TZ=America/New_York"
      - "PM_BASE_URL=http://192.168.1.100:5000"
      - "PM_SECRET=secret"
      - "PM_METRIC_NAMESPACE=phone.test"
      - "AWS_ACCESS_KEY_ID=key-id"
      - "AWS_SECRET_ACCESS_KEY=access-key"
      - "AWS_REGION=us-west-2"
    container_name: "${COMPOSE_PROJECT_NAME}-monitor"

  ofelia:
    image: mcuadros/ofelia:latest
    environment:
      - "TZ=America/New_York"
    restart: unless-stopped
    command: "daemon --docker -f label=com.docker.compose.project=${COMPOSE_PROJECT_NAME}"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock:ro
    labels:
      ofelia.enabled: "true"
      ofelia.job-run.monitor.schedule: "@every 5m"
      ofelia.job-run.monitor.container: "${COMPOSE_PROJECT_NAME}-monitor"
